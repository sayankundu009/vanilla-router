<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vanilla Router</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            <a class="navbar-brand" href="/">Vanilla Router</a>
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                <li class="nav-item">
                    <router-link to="/" class="nav-link active">Home</router-link>
                </li>
                <li class="nav-item">
                    <router-link to="/about" class="nav-link active">About</router-link>
                </li>
                <li class="nav-item">
                    <router-link to="/posts" class="nav-link active">Posts</router-link>
                </li>
            </ul>
        </div>
    </nav>

    <div class="m-2">
        <router-view></router-view>
    </div>
    
    <template page="home">
            <h1>Home</h1>
    </template>

    <template page="about">
            <h1>About</h1>
            <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Ducimus ut est eum earum expedita odio atque iste vero sed recusandae placeat pariatur praesentium ex blanditiis odit repellendus deleniti ipsam beatae, aliquam eos! Ut fuga fugiat doloremque suscipit reprehenderit, doloribus, facilis rem veniam, harum numquam molestias cum consectetur ipsum eos dolorem ex eligendi! Explicabo rerum tenetur aperiam non, temporibus, sunt molestias est iste delectus eaque obcaecati doloremque illo earum quia cum porro harum, ab dicta. Quibusdam assumenda perspiciatis eveniet qui atque aperiam voluptate hic modi dolores laboriosam, consequuntur minima. Eligendi earum fugiat explicabo officiis provident vel consequatur deserunt, maiores quaerat est?</p>

            <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Ducimus ut est eum earum expedita odio atque iste vero sed recusandae placeat pariatur praesentium ex blanditiis odit repellendus deleniti ipsam beatae, aliquam eos! Ut fuga fugiat doloremque suscipit reprehenderit, doloribus, facilis rem veniam, harum numquam molestias cum consectetur ipsum eos dolorem ex eligendi! Explicabo rerum tenetur aperiam non, temporibus, sunt molestias est iste delectus eaque obcaecati doloremque illo earum quia cum porro harum, ab dicta. Quibusdam assumenda perspiciatis eveniet qui atque aperiam voluptate hic modi dolores laboriosam, consequuntur minima. Eligendi earum fugiat explicabo officiis provident vel consequatur deserunt, maiores quaerat est?</p>
    </template>

    <template page="posts">
        <h1>Posts</h1>
    
        <div class="container">
            <div class="row" id="post-container">Loading...</div>
        </div>

        <script>
            fetch("https://api.nuxtjs.dev/posts")
            .then(res => res.json()).then(posts => {
                const fragment = document.createDocumentFragment();
                const postContainer = document.getElementById("post-container");

                fragment.innerHTML = ""

                posts.forEach(post => {
                    const { id, title, image} = post

                    fragment.innerHTML += `
                        <div class="card m-2 p-0" style="width: 18rem;" onclick="$router.redirect('/details/${id}')" role="button">
                            <img src="${image}" class="card-img-top" alt="post-image" style="width: 100%; height: 200px">
                            <div class="card-body">
                                <p class="card-text">${title}</p>
                            </div>
                        </div>
                    `; 
                });

                postContainer.innerHTML = fragment.innerHTML
            });
        </script>
    </template>

    <template page="posts-details">
        <div class="wrapper m-2 mt-4">        
            <div class="container">
                <div id="post-container">Loading...</div>
            </div>
        </div>

        <script>
            const { id } = $router.route.params

            fetch("https://api.nuxtjs.dev/posts/" + id)
            .then(res => res.json()).then(post => {
                const postContainer = document.getElementById("post-container");
                const { title, description, image} = post

                postContainer.innerHTML = `
                    <img src="${image}" class="img-thumbnail" alt="post-image" style="width: 100%; height: 500px; object-fit: cover">
                    <div class="mt-3">
                        <h1>${title}</h1>
                        <p>${description}</p>
                        <button class="btn btn-light" onclick="$router.redirect('/posts')">Back</button>
                    </div>
                `;
            });
        </script>
    </template>

    <script src="../dist/vanilla-router.js"></script>
    <script>
        const router = new VanillaRouter({
            routes: {
                "/": {
                    page: "home"
                },
                "/about": {
                    page: "about"
                },
                "/posts": {
                    page: "posts"
                },
                "/details/:id": {
                    page: "posts-details"
                },
            }
        });
    </script>
</body>
</html>